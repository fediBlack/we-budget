# ğŸ³ Docker Compose Configuration
# Ce fichier dÃ©finit tous les services qui tournent ensemble

version: '3.8'

services:
  # ğŸ—„ï¸ PostgreSQL - Base de donnÃ©es principale
  postgres:
    image: postgres:16-alpine  # Version lÃ©gÃ¨re de PostgreSQL 16
    container_name: webudget-postgres
    restart: unless-stopped
    ports:
      - '5432:5432'  # Port accessible depuis l'hÃ´te
    environment:
      # ğŸ¯ Credentials (en dur pour le dev, .env en prod)
      POSTGRES_USER: webudget
      POSTGRES_PASSWORD: webudget_dev_password
      POSTGRES_DB: webudget_db
    volumes:
      # ğŸ’¾ Persiste les donnÃ©es (survit au redÃ©marrage du container)
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      # âœ… VÃ©rifie que PostgreSQL est prÃªt
      test: ['CMD-SHELL', 'pg_isready -U webudget']
      interval: 10s
      timeout: 5s
      retries: 5

  # ğŸŒ Adminer - Interface web pour gÃ©rer la DB
  # AccÃ¨s : http://localhost:8080
  adminer:
    image: adminer:latest
    container_name: webudget-adminer
    restart: unless-stopped
    ports:
      - '8080:8080'  # Interface web
    depends_on:
      - postgres

# ğŸ“¦ Volumes persistants
volumes:
  postgres_data:
    driver: local

# ğŸ”— RÃ©seau (optionnel, Docker en crÃ©e un par dÃ©faut)
networks:
  default:
    name: webudget-network
